package com.zzp.print.test;

import com.alibaba.fastjson.JSON;
import com.zzp.print.PdfUtils;
import com.zzp.print.enums.SortTypeEnum;
import com.zzp.print.option.ExcelPrintSetupOption;
import org.apache.poi.hssf.usermodel.HSSFPrintSetup;
import org.apache.poi.ss.util.CellRangeAddress;

import java.util.HashMap;
import java.util.Map;

/**
 * @Description PdfUtils测试类
 * @Author zzp
 * @since 2019.10.16
 **/
public class TestPdfUtils {

    public static void main(String[] args) {
        String jsonStr = "{\"copLimits\":[],\"decUserInfos\":[],\"importExportDateStr\":\"\",\"bill\":{\"abroadPlaceCode\":\"AFG\",\"abroadPlaceName\":\"阿富汗\",\"associationDeclare\":\"\",\"associationFiling\":\"\",\"auditStatus\":0,\"billStatus\":0,\"billType\":2,\"billTypeCode\":\"W\",\"billTypeName\":\"无纸报关\",\"buyWayCode\":\"2\",\"buyWayName\":\"C&F\",\"checkDateYYYYMMDD\":\"\",\"companyCode\":\"4401963H4B\",\"contractNo\":\"\",\"copLimitViews\":[],\"copPromise\":\"\",\"creatDateYYYYMMDD\":\"2019-10-14\",\"createDate\":1571037288000,\"createUser\":8885,\"createUserName\":\"振朋001\",\"customCode\":\"0100\",\"customName\":\"北京关区\",\"decUserInfoViews\":[],\"declCiqCode\":\"\",\"declareCompanyCreditCode\":\"\",\"declareCompanyCustomsCode\":\"4401280159\",\"declareCompanyName\":\"广州市中海龙国际货运代理有限公司\",\"deliveryNo\":\"\",\"domesticConsigneeEname\":\"\",\"entranceDisplayCode\":\"2\",\"entyPortCode\":\"110801\",\"entyPortName\":\"北京西站\",\"goodsPlace\":\"\",\"grossWeight\":\"2\",\"id\":17890,\"importExportCustomCode\":\"0103\",\"importExportCustomName\":\"京关展览\",\"insurancePriceUnitCode\":\"\",\"levyWayCode\":\"118\",\"levyWayName\":\"整车征税\",\"licenseNo\":\"\",\"loadPlaceCode\":\"991101\",\"loadPlaceName\":\"北京天竺综合保税区\",\"lockStatus\":0,\"markNo\":\"N/M\",\"multipleCalculateName\":\"\",\"multiplePrice\":\"0.3\",\"multiplePriceUnitCode\":\"\",\"multiplePriceUnitName\":\"\",\"netWeight\":\"2\",\"otherPackViews\":[{\"billId\":0,\"createId\":0,\"id\":460,\"packType\":\"04\",\"packTypeName\":\"球状罐类\",\"updateId\":0}],\"overseasConsigneeCode\":\"O741258963\",\"overseasConsigneeEname\":\"\",\"overseasConsignorCname\":\"\",\"ownerCiqCode\":\"1234567891\",\"packNum\":1,\"packTypeCode\":\"22\",\"packTypeName\":\"纸制或纤维板制盒/箱\",\"produceConsumeCompanyCreditCode\":\"33333333\",\"produceConsumeCompanyCustomsCode\":\"4401963H4B\",\"produceConsumeCompanyName\":\"名创优品国际（广州）有限公司\",\"productTotal\":2,\"qpCustomCode\":\"2019101200003\",\"recordCode\":\"\",\"regulateNo\":\"\",\"regulateWayCode\":\"0130\",\"regulateWayName\":\"易货贸易\",\"remark\":\"备注测试33333333\",\"requestCertViews\":[],\"sendReceiveCompanyCreditCode\":\"33333333\",\"sendReceiveCompanyCustomsCode\":\"4401963H4B\",\"sendReceiveCompanyName\":\"名创优品国际（广州）有限公司\",\"serialNo\":49,\"status\":0,\"tradeCiqCode\":\"9876543210\",\"tradePlaceCode\":\"AGO\",\"tradePlaceName\":\"安哥拉\",\"tradeType\":1,\"transportCalculateName\":\"单价\",\"transportCalculateType\":2,\"transportPrice\":\"333\",\"transportPriceUnit\":8,\"transportPriceUnitCode\":\"CNY\",\"transportPriceUnitName\":\"人民币\",\"transportTool\":\"\",\"transportVoyageNo\":\"\",\"transportWayCode\":\"3\",\"transportWayName\":\"铁路运输\",\"updateDate\":1571037409000,\"updateUser\":8885,\"updateUserName\":\"振朋001\",\"version\":0,\"yardCode\":\"\",\"yardCustomCode\":\"\",\"yardName\":\"\",\"yardNo\":\"\"},\"otherPacksStr\":\"/球状罐类\",\"paySpecialCashStr\":\"\",\"otherPacks\":[{\"$ref\":\"$.bill.otherPackViews[0]\"}],\"priceAffectStr\":\"\",\"productOrders2\":[],\"printPageCount\":1,\"productOrders\":[{\"billId\":17890,\"ciqCode\":\"ciq\",\"ciqName\":\"ciq_name\",\"containerxNo\":\"\",\"correspondRelationId\":\"ff8080816ade195a016adef40513000c\",\"createIndex\":\"1570773746456\",\"dangName\":\"\",\"dangPackSpec\":\"\",\"dangPackTypeName\":\"\",\"dangpacktype\":\"\",\"declareElementJson\":\"[{\\\"index\\\":0,\\\"name\\\":\\\"品牌类型\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"1\\\"},{\\\"index\\\":1,\\\"name\\\":\\\"出口享惠情况\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"2\\\"},{\\\"index\\\":2,\\\"name\\\":\\\"品牌\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"MINISO牌\\\"},{\\\"index\\\":3,\\\"name\\\":\\\"型号\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"无型号\\\"},{\\\"index\\\":4,\\\"name\\\":\\\"GTIN\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"师傅师傅师傅\\\"},{\\\"index\\\":5,\\\"name\\\":\\\"CAS\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"滴滴滴滴\\\"},{\\\"index\\\":6,\\\"name\\\":\\\"其他\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"带耳机包\\\"}]\",\"declareElementValues\":\"1|2|MINISO牌|无型号|师傅师傅师傅|滴滴滴滴|带耳机包\",\"districtCode\":\"44019\",\"districtName\":\"广州其他\",\"eProductNo\":\"\",\"eProductVersion\":\"\",\"endCountryCode\":\"AFG\",\"endCountryName\":\"阿富汗\",\"engManEntCnm\":\"\",\"firstLegalNum\":\"2\",\"firstLegalUnitCode\":\"007\",\"firstLegalUnitName\":\"个\",\"goodsAttr\":\"\",\"goodsAttrName\":\"\",\"goodsBrand\":\"\",\"goodsCode\":\"\",\"goodsDescEn\":\"\",\"goodsEname\":\"\",\"goodsLimitViews\":[],\"goodsModel\":\"\",\"goodsSpec\":\"\",\"hscode\":\"85183000\",\"id\":42541,\"inspectionoriginCode\":\"\",\"inspectionoriginName\":\"\",\"levyTypeCode\":\"7\",\"levyTypeName\":\"保函\",\"lineNum\":1,\"manualSequNo\":\"GB-01\",\"mnufctrRegno\":\"\",\"moneyTypeCode\":\"CNY\",\"moneyTypeName\":\"人民币\",\"moneyTypeSymbol\":\"\",\"noDangFlag\":\"\",\"noDangFlagName\":\"\",\"num\":\"1\",\"origPlaceCode\":\"\",\"origPlaceName\":\"\",\"pkgNo\":\"\",\"pkgsCatgCode\":\"\",\"pkgsCatgName\":\"\",\"processingFees\":\"\",\"prodBatchNo\":\"\",\"prodQgp\":\"\",\"prodValidDt\":\"\",\"produceDate\":\"\",\"productAttachCode\":\"00\",\"productDeclareElements\":[{\"index\":0,\"name\":\"品牌类型\",\"tip\":\"\",\"type\":0,\"value\":\"1\"},{\"index\":1,\"name\":\"出口享惠情况\",\"tip\":\"\",\"type\":0,\"value\":\"2\"},{\"index\":2,\"name\":\"品牌\",\"tip\":\"\",\"type\":0,\"value\":\"MINISO牌\"},{\"index\":3,\"name\":\"型号\",\"tip\":\"\",\"type\":0,\"value\":\"无型号\"},{\"index\":4,\"name\":\"GTIN\",\"tip\":\"\",\"type\":0,\"value\":\"师傅师傅师傅\"},{\"index\":5,\"name\":\"CAS\",\"tip\":\"\",\"type\":0,\"value\":\"滴滴滴滴\"},{\"index\":6,\"name\":\"其他\",\"tip\":\"\",\"type\":0,\"value\":\"带耳机包\"}],\"productGrossWeight\":\"\",\"productId\":181421,\"productName\":\"入耳式耳机\",\"productNetWeight\":\"\",\"productNo\":\"8518300000\",\"productOrderDeclareElements\":[],\"purpose\":\"\",\"purposeName\":\"\",\"recordProductNo\":\"\",\"secondLegalNum\":\"\",\"singlePrice\":\"1\",\"startCountryCode\":\"CHN\",\"startCountryName\":\"中国\",\"stuff\":\"\",\"totalPrice\":\"1\",\"unCode\":\"\",\"unitCode\":\"009\",\"unitName\":\"头\"},{\"billId\":17890,\"ciqCode\":\"ciq\",\"ciqName\":\"ciq_name\",\"containerxNo\":\"\",\"correspondRelationId\":\"ff8080816ade195a016adef40513000c\",\"createIndex\":\"1571037407141\",\"dangName\":\"\",\"dangPackSpec\":\"\",\"dangPackTypeName\":\"\",\"dangpacktype\":\"\",\"declareElementJson\":\"[{\\\"index\\\":0,\\\"name\\\":\\\"品牌类型\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"1\\\"},{\\\"index\\\":1,\\\"name\\\":\\\"出口享惠情况\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"2\\\"},{\\\"index\\\":2,\\\"name\\\":\\\"品牌\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"MINISO牌\\\"},{\\\"index\\\":3,\\\"name\\\":\\\"型号\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"无型号\\\"},{\\\"index\\\":4,\\\"name\\\":\\\"GTIN\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"师傅师傅师傅\\\"},{\\\"index\\\":5,\\\"name\\\":\\\"CAS\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"滴滴滴滴\\\"},{\\\"index\\\":6,\\\"name\\\":\\\"其他\\\",\\\"tip\\\":\\\"\\\",\\\"type\\\":0,\\\"value\\\":\\\"带耳机包\\\"}]\",\"declareElementValues\":\"1|2|MINISO牌|无型号|师傅师傅师傅|滴滴滴滴|带耳机包\",\"districtCode\":\"44019\",\"districtName\":\"广州其他\",\"eProductNo\":\"\",\"eProductVersion\":\"\",\"endCountryCode\":\"AFG\",\"endCountryName\":\"阿富汗\",\"engManEntCnm\":\"\",\"firstLegalNum\":\"2\",\"firstLegalUnitCode\":\"007\",\"firstLegalUnitName\":\"个\",\"goodsAttr\":\"\",\"goodsAttrName\":\"\",\"goodsBrand\":\"\",\"goodsCode\":\"\",\"goodsDescEn\":\"\",\"goodsEname\":\"\",\"goodsLimitViews\":[],\"goodsModel\":\"\",\"goodsSpec\":\"\",\"hscode\":\"85183000\",\"id\":42591,\"inspectionoriginCode\":\"\",\"inspectionoriginName\":\"\",\"levyTypeCode\":\"7\",\"levyTypeName\":\"保函\",\"lineNum\":2,\"manualSequNo\":\"GB-01\",\"mnufctrRegno\":\"\",\"moneyTypeCode\":\"CNY\",\"moneyTypeName\":\"人民币\",\"moneyTypeSymbol\":\"\",\"noDangFlag\":\"\",\"noDangFlagName\":\"\",\"num\":\"1\",\"origPlaceCode\":\"\",\"origPlaceName\":\"\",\"pkgNo\":\"\",\"pkgsCatgCode\":\"\",\"pkgsCatgName\":\"\",\"plicationDetialId\":\"\",\"processingFees\":\"\",\"prodBatchNo\":\"\",\"prodQgp\":\"\",\"prodValidDt\":\"\",\"produceDate\":\"\",\"productAttachCode\":\"00\",\"productDeclareElements\":[{\"index\":0,\"name\":\"品牌类型\",\"tip\":\"\",\"type\":0,\"value\":\"1\"},{\"index\":1,\"name\":\"出口享惠情况\",\"tip\":\"\",\"type\":0,\"value\":\"2\"},{\"index\":2,\"name\":\"品牌\",\"tip\":\"\",\"type\":0,\"value\":\"MINISO牌\"},{\"index\":3,\"name\":\"型号\",\"tip\":\"\",\"type\":0,\"value\":\"无型号\"},{\"index\":4,\"name\":\"GTIN\",\"tip\":\"\",\"type\":0,\"value\":\"师傅师傅师傅\"},{\"index\":5,\"name\":\"CAS\",\"tip\":\"\",\"type\":0,\"value\":\"滴滴滴滴\"},{\"index\":6,\"name\":\"其他\",\"tip\":\"\",\"type\":0,\"value\":\"带耳机包\"}],\"productGrossWeight\":\"\",\"productId\":181421,\"productName\":\"入耳式耳机\",\"productNetWeight\":\"\",\"productNo\":\"8518300000\",\"productOrderDeclareElements\":[],\"purpose\":\"\",\"purposeName\":\"\",\"recordProductNo\":\"\",\"secondLegalNum\":\"\",\"singlePrice\":\"1\",\"startCountryCode\":\"CHN\",\"startCountryName\":\"中国\",\"stuff\":\"\",\"totalPrice\":\"1\",\"unCode\":\"\",\"unitCode\":\"009\",\"unitName\":\"头\"}],\"productOrders1\":[{\"$ref\":\"$.productOrders[0]\"},{\"$ref\":\"$.productOrders[1]\"}],\"billSuperviseCardsStr\":\"进口许可证(1)(1111)  两用物项和技术出口许可证(3)(345DDD)  \",\"goodsLimitVins\":[],\"billSuperviseCards\":[{\"id\":2790,\"lineNum\":1,\"superviseCardCode\":\"1\",\"superviseCardId\":1,\"superviseCardName\":\"进口许可证\",\"superviseCardValue\":\"1111\"},{\"id\":2791,\"lineNum\":2,\"superviseCardCode\":\"3\",\"superviseCardId\":3,\"superviseCardName\":\"两用物项和技术出口许可证\",\"superviseCardValue\":\"345DDD\"}],\"billProductOrderSuperviseCard\":[],\"billInspection\":{\"billId\":17890,\"correlationNo\":\"\",\"correlationReasonFlag\":\"\",\"correlationReasonName\":\"\",\"id\":299,\"inspOrgCode\":\"\",\"inspOrgName\":\"\",\"orgCode\":\"\",\"orgName\":\"\",\"purpOrgCode\":\"\",\"purpOrgName\":\"\",\"specDeclFlag\":\"\",\"vsaOrgCode\":\"\",\"vsaOrgName\":\"\"},\"specialRelationStr\":\"\",\"containers\":[],\"goodsLimits\":[],\"ie\":\"E\",\"requestCerts\":[],\"declareDateStr\":\"\"}";
        Map<String, Object> map = (Map<String, Object>) JSON.parseObject(jsonStr, Map.class);
        Map<String, Map<String, Object>> datas = new HashMap<String, Map<String, Object>>();
        datas.put("test.xls", map);

        Map<String, Integer> pageCountMap = new HashMap<String, Integer>();
        pageCountMap.put("test.xls", 1);


        String excelTemplateFilePath = "E:\\scmtemp\\bill-batch-export-E.xls";
        String exportFolderPath = "E:\\scmtemp\\hlctest";
        String exportExcelFolderPath = "E:\\scmtemp\\hlctest\\excel";
        String exportPdfFolderPath = "E:\\scmtemp\\hlctest\\pdf";

        try {
            ExcelPrintSetupOption printSetupOption = new ExcelPrintSetupOption();
            printSetupOption.setLandscape(true);
            printSetupOption.setPaperSize(HSSFPrintSetup.A4_PAPERSIZE);
            printSetupOption.setTopMargin(0.436);
            printSetupOption.setBottomMargin(0.52);
            printSetupOption.setLeftMargin(0.316);
            printSetupOption.setRightMargin(0.244);
            printSetupOption.setHeaderMargin(0.304);
            printSetupOption.setFooterMargin(0.304);
            printSetupOption.setHorizontallyCenter(true);
            CellRangeAddress cellRangeAddress = new CellRangeAddress(20, 20, 0, 0);
            printSetupOption.setRepeatingRows(cellRangeAddress);

            PdfUtils.merge(excelTemplateFilePath, exportFolderPath, exportExcelFolderPath, exportPdfFolderPath, datas, pageCountMap, printSetupOption, SortTypeEnum.DESC.getCode());
            System.out.println("合并完成");
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

}
